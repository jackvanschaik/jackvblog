---
title: "Tidy Tuesday 10-13-2020"
author: "Jack VanSchaik"
description: "Which words are worth the most?"
date: 2020-10-13
categories: ["TidyTuesday"]
tags: ["R Markdown", "R", "TidyTuesday", "Tidyverse"]
twitterImg: /images/tidy_2.png
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Packages

I'll use `tidyverse` for data wrangling and plotting, and `gganimate` and `ggthemes` to make my plots more interesting.

```{r, results="hide", message=FALSE}
library(tidyverse)
library(gganimate)
library(ggthemes)
```

## Load Data

Data acquired as described on the [Tidy Tuesday Github](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-10-13/readme.md):

```{r}
tuesdata <- tidytuesdayR::tt_load('2020-10-13')
ds <- tuesdata$datasaurus
```

## Visualize Raw Data

The `datasauRus` package contains a dataset of 13 set of coordinates that have some almost identical summary statistics. Again borrowing code from the GitHub page:

```{r}
ggplot(ds, aes(x=x, y=y, colour=dataset))+
  geom_point()+
  theme_void()+
  theme(legend.position = "none")+
  facet_wrap(~dataset, ncol=3)
```


## How dino shaped is the data?

The means, standard deviations, and correlations of the above data are all the same. Clearly these summary statistics have some deficiencies. I'll come up with new statistic, "Dino Distance". This new metric will measure this average distance in a dataset to the corresponding closest point in the dino dataset. 

#### Animation

Get the closest point in the dino dataset to each point in the other datasets:

```{r}
ds %>%
    filter(dataset == "dino") %>%
    transmute(
        dino_x = x,
        dino_y = y
    ) ->
    dino

nearest_dino <- function(x_0, y_0) {
    dino %>%
        mutate(
            x_1 = x_0, 
            y_1 = y_0,
            dist = sqrt((x_1 - dino_x)^2 + (y_1 - dino_y)^2)
        ) %>%
        arrange(dist) %>%
        head(n = 1) %>%
        select(dino_x, dino_y, dist) ->
        nearest
    
    nearest
}

ds %>%
    mutate(n_d = map2(x, y, nearest_dino)) %>%
    unnest(cols=c(n_d)) ->
    ds_2

ds_3 <- bind_rows(
    ds_2 %>%
        select(dataset, x, y) %>%
        mutate(state = "normal"),
    ds_2 %>%
        transmute(
            dataset,
            x = dino_x,
            y = dino_y,
            state = "dino"
        )
    
)
```

Create an animation of a few datasets closing the Dino Distance:

```{r}
anim <- ds_3 %>%
    filter(dataset %in% c("bullseye", "dino", "v_lines", "x_shape")) %>%
    ggplot(aes(x = x, y = y, color=dataset)) +
    geom_point() +
    facet_wrap(.~ dataset)  +
    theme_hc() +
    theme( 
        strip.background = element_blank(),
        strip.text.x = element_blank()
    ) +
    labs(x = "X", y="Y", title="Nearest Dino Point (Animation)",
         caption = "Tidy Tuesday 10-13-2020. Data from the datasauRus package") +
    transition_states(state, transition_length = 1, state_length =  2)

animate(anim, duration = 3, fps = 20, width = 400, height = 400, renderer = gifski_renderer())
```

#### Get Distance

Finally, I'll calculate the Dino Distance for each dataset:

```{r}
ds_2 %>%
    group_by(dataset) %>%
    summarise(dino_dist = mean(dist)) %>%
    ungroup %>%
    arrange(desc(dino_dist)) %>%
    mutate(dataset=factor(dataset, levels=dataset)) %>%
    ggplot(aes(x=dataset, y=dino_dist)) + 
        geom_bar(stat="identity") +
        coord_flip() + 
    labs(y = "Dino Distance", x="Data Set", title="Dino Distance by Dataset",
         caption = "Tidy Tuesday 10-13-2020. Data from the datasauRus package") +
    theme_hc()
```


## Session Info

```{r}
session_info()
```

